<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name = "viewport" content = "width=device-width, initial-scale=1.0"/>
    <title>Crypto Futures Risk Calculator</title>
    <style>
        body {
            font-family: sans-serif;
            background: #f9f9f9;
            padding: 20px;
            max-width: 600px;
            margin: auto;
        }
        input {
            width: 100%;
            padding: 8px;
            margin: 6px 0 12px;
            box-sizing: border-box;
        }
        label {
            font-weight: bold;
        }
        .result {
            background: #fff;
            padding: 10px;
            border: 1px solid #ddd;
            margin-top: 10px;
        }
    </style>
    
</head>
<body>
<h2>Crypto Futures Risk Calculator</h2>

<label >Entry Price (USDT)</label>
<input type="number" id="entryPrice" step="any"/>

<label >Leverage</label>
<input type="number" id="leverage" step="any"/>

<label >Margin Used (USDT)</label>
<input type="number" id="margin" step="any"/>

<label >Take Profit Price (optional)</label>
<input type="number" id="tp" step="any"/>

<label >Stop Loss Price (optional)</label>
<input type="number" id="sl" step="any"/>

<button onclick = "calculate()">Calculate</button>

<div class="result" id="output"></div>

<script>
    function calculate() {
    const entry = parseFloat(document.getElementById("entryPrice").value);
    const lev = parseFloat(document.getElementById("leverage").value);
    const margin = parseFloat(document.getElementById("margin").value);
    const tp = parseFloat(document.getElementById("tp").value);
    const sl = parseFloat(document.getElementById("sl").value);

    if (!entry || !lev || !margin) {
        document.getElementById("output").innerHTML = "Please enter Entry, Leverage, and Margin";
        return;
    }

    const liq = entry * (1 - (1 / lev));
    const posSize = (margin * lev) / entry;

    // SMART STOP LOSS
    const smartSL = sl || entry * 0.95;

    let risk = posSize * (entry - smartSL);
    let reward = tp ? posSize * (tp - entry) : "N/A";
    let rr = (typeof reward === "number" && risk !== 0) ? (reward / risk) : "N/A";

    // Take profit zones (2R, 3R)
    const tp2R = entry + 2 * (entry - smartSL);
    const tp3R = entry + 3 * (entry - smartSL);

    // Stop Loss Warning
    let slWarning = (smartSL - liq) < entry * 0.05 ? "YES" : "NO";

    document.getElementById("output").innerHTML = `
    <p><b>Estimated Liquidation Price:</b> ${liq.toFixed(6)}</p>
    <p><b>Position Size (Tokens):</b> ${posSize.toFixed(6)}</p>
    <p><b>Smart Stop Loss (5% below entry if not provided):</b> ${smartSL.toFixed(6)}</p>
    <p><b>Risk if SL Hits:</b> ${risk.toFixed(4)} USDT</p>
    <p><b>Reward if TP Hits:</b> ${typeof reward === "number" ? reward.toFixed(4) + " USDT" : reward}</p>
    <p><b>Risk:Reward Ratio:</b> ${typeof rr === "number" ? rr.toFixed(2) : rr}</p>
    <p><b>Suggested Take Profit Points:</b>
      <ul>
        <li>2R Take Profit: ${tp2R.toFixed(6)}</li>
        <li>3R Take Profit: ${tp3R.toFixed(6)}</li>
      </ul>
    </p>
    <p><b>Stop Loss Close to Liq?</b> <span class="${slWarning === 'YES' ? 'warning' : ''}">${slWarning}</span></p>
    `;
}
</script>

<p><b></b></p>

</body>

</html>